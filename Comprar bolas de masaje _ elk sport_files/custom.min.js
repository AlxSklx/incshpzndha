define(["jquery",'lodash'],function($){"use strict";$(document).ready(function(){var oct8nechecker=setInterval(function(){if($('#livechat-wrapper, #oct8ne-viewer-wrapper').length){$('#livechat-wrapper , #oct8ne-viewer-wrapper').on('click',function(){$('body').toggleClass('chat-active');$('body').addClass('chat-was-active');});clearInterval(oct8nechecker);}},300);var activeTooltip=$('#aplazado-como'),tooltip=$('#instructions-tooltip');if(activeTooltip.length&&tooltip.length){activeTooltip.on('mouseover',function(){tooltip.show();});activeTooltip.on('mouseleave',function(){tooltip.hide();});activeTooltip.on('click',function(){if(tooltip.is(':visible')){tooltip.hide();}else{tooltip.show();}});}
var disabled_regions=['145','157','163','170'];var regionsIntervalChecker=setInterval(function(){$("select[name='region_id']").each(function(){$(this).find('option').each(function(){if(disabled_regions.indexOf($(this).attr('value'))>=0){$(this).remove();}});});},1000);$('.level2.nav-dropdown .nav-item:last-of-type').each(function(){$(this).css('position','relative');$(this).find('.dropdown-menu').each(function(){$(this).on('mouseout',function(){$(this).removeClass('active');});});$(this).find('.nav-anchor').on('mouseover',function(){$('.dropdown-menu.active').each(function(){$(this).removeClass('active');});$(this).next().addClass('active');});});$('.nav-item.level-top').each(function(){$(this).on('mouseenter',function(){$('.dropdown-menu.active').each(function(){$(this).removeClass('active');});});});$('[data-open-modal]').each(function(){$(this).click(function(e){var modal='[data-modal='+$(this).attr('data-open-modal')+']';$(modal).fadeIn();$(modal).find('.close').click(function(){$(modal).fadeOut();});});});var catalog=$('.catalog-product-view'),message=catalog.find('.message-success');if(message.length){message.append('<a href="/checkout">Pagar</a>');}
if($('.catalog-product-view').length&&!$('#product-addtocart-button').length){var priceCheckInterval=setInterval(function(){var priceReference=$('.product-info-price .price-excluding-tax .price');if(priceReference.length&&priceReference.text().indexOf('0,00')!==-1){var product=$('#elk_product_info_main .price-box'),conIVA=product.find('.price-including-tax'),sinIVA=product.find('.price-excluding-tax');var currency=conIVA.find('span').text().substring(conIVA.find('span').text().length-1);if(sinIVA.length){sinIVA.html('<span class="price">'+parseFloat(sinIVA.attr('data-price-amount')).toFixed(2)+' '+currency+'</span>');}
if(conIVA.length){conIVA.html('<span class="price">'+parseFloat(conIVA.attr('data-price-amount')).toFixed(2)+' '+currency+'</div>');}}
if(priceReference.length&&priceReference.text().indexOf('0,00')==-1){}},500);}
function stopInterval(interval){clearInterval(interval);}
var headerMobile=$('.elk-header-mobile'),menuOpen=headerMobile.find('[href="#header-nav"]'),menuClose=$('#close-main-menu'),menuNav=$('#main-menu'),items=menuNav.find('.nav-item');reset(items);menuClose.click(function(e){e.preventDefault();menuNav.removeClass('open');reset(items);});menuOpen.click(function(e){e.preventDefault();menuNav.addClass('open');});items.each(function(){activeOpeners($(this));});function activeOpeners(element){element.find('.opener').first().on('click',function(e){e.preventDefault();var current=setCurrent(element);if(current.hasClass('is-active')){close(element);}else{open(element);}});}
function reset(items){items.each(function(){$(this).find('.item-active').each(function(){$(this).trigger('click');});});}
function open(item){var parent=setParent(item),finder=setFinder(item),current=setCurrent(item);current.addClass('is-active');parent.find(finder).each(function(){if(!$(this).hasClass('is-active')){$(this).fadeOut();}});}
function close(item){var parent=setParent(item),finder=setFinder(item),current=setCurrent(item);current.removeClass('is-active');parent.find(finder).each(function(){current.removeClass('is-active');$(this).fadeIn();});}
function setCurrent(item){var level=checkLevel(item);if(level==='level1'){return item.parent();}else if(level==='level2'){return item.parent();}else{return item;}}
function setParent(item){var level=checkLevel(item);if(level==='level1'){return item.parent().parent();}else if(level==='level2'){return item.parent().parent();}else{return item.parent();}}
function setFinder(item){var level=checkLevel(item);if(level==='level1'){return'> .mega-col';}else if(level==='level2'){return'> .mega-col';}else{return'> .nav-item';}}
function checkLevel(item){if(item.hasClass('level1')){return'level1';}else if(item.hasClass('level2')){return'level2';}else{return'level0';}}
var textPerPage=$('.limiter .limiter-text').first();$('#limiter').find('option').each(function(){var currentValue=$(this).text();$(this).text(currentValue+' '+textPerPage.text());});$('[data-link-to]').click(function(){window.location.href=$(this).attr('data-link-to');});$('.filter-content .block-subtitle').click(function(){$(this).parent().toggleClass('is-active');});var createAccountForm=$('form.elk-account-form'),customerGroup=createAccountForm.find('#group_id');function setFormData(groupId){$('.field.elk_a_la_atencion_de').hide();if(groupId==='3'){$('.field.elk_persona_contacto').hide();$('.field.field-name-firstname').find('span').text('Nombre');$('.field.field-name-firstname').find('input').attr('placeholder','Ej: Juan');$('.field.field-name-lastname').show();}else{$('.field.elk_persona_contacto').show();$('.field.field-name-firstname').find('span').text('Razón social');$('.field.field-name-firstname').find('input').attr('placeholder','Ej: Miempresa S.L.');$('.field.field-name-lastname').hide();if(groupId==='2'){$('.field.elk_a_la_atencion_de').show();}}}
setFormData(customerGroup.val());customerGroup.on('change',function(){$('.field.hidden').removeClass('hidden');var groupId=$(this).val();setFormData(groupId);});var menu=$('.ves-megamenu'),slider=menu.find('.carousel');if(slider.length){slider.each(function(){var controls=$(this).find('.carousel-controls'),items=$(this).find('.product-items'),prev=controls.find('.left'),next=controls.find('.right');var timer=setInterval(function(){next.trigger('click')},5000);prev.click(function(e){e.preventDefault();clearInterval(timer);timer=setInterval(function(){next.trigger('click')},5000);var active=items.find('.active').removeClass('active');if(!active.prev().length){items.find('.item').last().addClass('active');}else{active.prev().addClass('active');}});next.click(function(e){e.preventDefault();clearInterval(timer);timer=setInterval(function(){next.trigger('click')},5000);var active=items.find('.active').removeClass('active');if(!active.next().length){items.find('.item').first().addClass('active');}else{active.next().addClass('active');}});});}
var firstTime=true,mobileMenu=$('.header-m-primary .skip-links-wrapper'),stickyOffset=0;if(mobileMenu.length){stickyOffset=mobileMenu.offset().top;}
checkScrollerEvents();checkResponsive();firstTime=false;$(window).on('resize',_.throttle(checkResponsive,1000));$(window).on('scroll',_.throttle(checkScrollerEvents,500));function checkScrollerEvents(){var scroll=$(window).scrollTop();if(mobileMenu.length){if(scroll>=stickyOffset){mobileMenu.addClass('fixed');}else{mobileMenu.removeClass('fixed');}}
var miniCart=$('#minicart'),headerLinks=$('.header.links');if($(window).width()>=992&&$('.sticky-header').length){headerLinks.prependTo('.ves-menu');miniCart.prependTo('.ves-menu');}else{if($(window).width()>768){if(!firstTime){miniCart.insertBefore('#mini-cart-marker-regular');}}else{miniCart.insertBefore('#header-nav');}
if(!firstTime){headerLinks.prependTo('#header-account');}}}
function checkResponsive(){if($(window).width()<=768){$(".category-view").insertBefore(".columns");$('#toolbar-amount').insertAfter('.toolbar-sorter');}else if($(window).width()<=1170){$('.fullfix').each(function(){$(this).parent().css('margin-bottom',0);});}else{$(".category-view").prependTo(".column.main");$('.fullfix').each(function(){var height=$(this).outerHeight();$(this).parent().css('margin-bottom',height+40);});}}
if($('#header-account').length){$('#header-account .header.links').on('mouseenter',function(){$('#header-account .customer-links').addClass('active');});}
if($('.ves-menu.ves-megamenu-mobile').length){$('.ves-menu.ves-megamenu-mobile .header.links').on('mouseenter',function(){$('#header-account .customer-links').addClass('active');});}
if($('#header-account').length){$('#header-account .customer-links').on('mouseleave',function(){$('#header-account .customer-links').removeClass('active');if($('#header-account .customer-links').hasClass('fixed')){$('#header-account .customer-links').removeClass('fixed');}});}
if($('#search_mini_form').length){$('#search_mini_form').on('submit',function(e){e.preventDefault();});}});setTimeout(function(){$('.df-classic').each(function(index){if(index==1){$(this).remove();}});},3000);setInterval(function(){if(!$('#envios-especiales-link').length&&$('body').hasClass('checkout-index-index')){$('[name="shippingAddress.street.0"]').before('<a id="envios-especiales-link" href="/envios-especiales">Envíos a Canarias, Ceuta, Melilla u otros destinos. Click aquí</a>')}},500);return;});